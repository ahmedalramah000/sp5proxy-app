<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP5Proxy Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css?v=20250625001">
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="spinner-border" role="status"></div>
        <p class="mt-2">Loading...</p>
    </div>

    <!-- Toast Notifications Container -->
    <div class="toast-container"></div>
    
    <!-- Top Bar -->
    <div id="topbar" class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <button id="sidebar-toggle" class="btn d-md-none">
                <i class='bx bx-menu'></i>
            </button>
            <img src="/img/logo.png" alt="SP5Proxy Logo" height="35" class="me-2">
            <h5 class="mb-0">SP5Proxy Admin</h5>
        </div>
        <div class="d-flex align-items-center">
            <div class="dropdown">
                <button class="btn dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class='bx bx-user-circle me-1'></i>
                    <span id="username">Admin</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                    <li><a class="dropdown-item" href="#" id="profile-link"><i class='bx bx-user me-2'></i>Profile</a></li>
                    <li><a class="dropdown-item" href="#" id="settings-link"><i class='bx bx-cog me-2'></i>Settings</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="#" id="logout-link"><i class='bx bx-log-out me-2'></i>Logout</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Sidebar -->
    <div id="sidebar">
        <div class="py-3 px-4 d-flex justify-content-center">
            <span class="fs-5 fw-semibold">Navigation</span>
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link active" href="#dashboard" data-page="dashboard">
                    <i class='bx bx-home'></i> Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#sessions" data-page="sessions">
                    <i class='bx bx-desktop'></i> Active Sessions
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#users" data-page="users">
                    <i class='bx bx-user'></i> Users
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#url-services" data-page="url-services">
                    <i class='bx bx-link'></i> URL Services
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#logs" data-page="logs">
                    <i class='bx bx-list-ul'></i> Connection Logs
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#settings" data-page="settings">
                    <i class='bx bx-cog'></i> System Settings
                </a>
            </li>
        </ul>
        <div class="mt-5 px-4 pb-3">
            <div class="d-flex align-items-center">
                <i class='bx bx-signal-5 me-2'></i>
                <div>
                    <div class="small text-white-50">Server Status</div>
                    <div class="fw-semibold text-light"><span id="server-status">Connected</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div id="content">
        <!-- Page content containers will be dynamically created and populated -->
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">SP5Proxy Admin Login</h5>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="username-input" class="form-label">Username</label>
                        <input type="text" class="form-control" id="username-input" placeholder="Enter username">
                    </div>
                    <div class="mb-3">
                        <label for="password-input" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password-input" placeholder="Enter password">
                    </div>
                    <div class="alert alert-danger d-none" id="login-error"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="login-btn">Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Page Templates (hidden) -->
    <!-- Dashboard Page Template -->
    <template id="template-dashboard">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">Dashboard</h3>
                </div>
            </div>
            
            <!-- Stats Row -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card stat-card primary p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Active Users</h6>
                                <h3 class="mb-0" id="active-users">0</h3>
                            </div>
                            <i class='bx bx-user'></i>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3">
                    <div class="card stat-card success p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Total Users</h6>
                                <h3 class="mb-0" id="total-users">0</h3>
                            </div>
                            <i class='bx bx-group'></i>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3">
                    <div class="card stat-card info p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Today's Connections</h6>
                                <h3 class="mb-0" id="today-connections">0</h3>
                            </div>
                            <i class='bx bx-plug'></i>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3">
                    <div class="card stat-card warning p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Extensions Today</h6>
                                <h3 class="mb-0" id="extensions-today">0</h3>
                            </div>
                            <i class='bx bx-time-five'></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Sessions -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Recent Active Sessions</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Proxy</th>
                                            <th>External IP</th>
                                            <th>Location</th>
                                            <th>Started</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="active-sessions-table">
                                        <tr>
                                            <td colspan="6" class="text-center">Loading sessions...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- System Stats -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">URL Services Status</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between mb-4">
                                <div>
                                    <h6 class="text-muted">Active Services</h6>
                                    <h3 id="active-services">0</h3>
                                </div>
                                <div>
                                    <h6 class="text-muted">Total Services</h6>
                                    <h3 id="total-services">0</h3>
                                </div>
                            </div>
                            <div>
                                <h6 class="text-muted mb-2">Most Used Service</h6>
                                <div id="most-used-service">None</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">System Settings</h5>
                        </div>
                        <div class="card-body" id="system-settings-overview">
                            <div class="d-flex justify-content-between mb-3">
                                <span>Trial System</span>
                                <span class="badge bg-success" id="trial-system-status">Enabled</span>
                            </div>
                            <div class="d-flex justify-content-between mb-3">
                                <span>Extension System</span>
                                <span class="badge bg-success" id="extension-system-status">Enabled</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Server Status</span>
                                <span class="badge bg-success" id="server-status-badge">Online</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Sessions Page Template -->
    <template id="template-sessions">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">Active Sessions</h3>
                </div>
            </div>

            <!-- Sessions Stats -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card stat-card primary p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Current Sessions</h6>
                                <h3 class="mb-0" id="current-sessions">0</h3>
                            </div>
                            <i class='bx bx-broadcast'></i>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3">
                    <div class="card stat-card success p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Sessions Today</h6>
                                <h3 class="mb-0" id="sessions-today">0</h3>
                            </div>
                            <i class='bx bx-calendar'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card stat-card info p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Disconnections</h6>
                                <h3 class="mb-0" id="disconnections-today">0</h3>
                            </div>
                            <i class='bx bx-plug'></i>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-3">
                    <div class="card stat-card warning p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Unique Users</h6>
                                <h3 class="mb-0" id="unique-users-today">0</h3>
                            </div>
                            <i class='bx bx-user-check'></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sessions Table -->
            <div class="card">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Active Sessions</h5>
                    <button id="refresh-sessions" class="btn btn-sm btn-primary">
                        <i class='bx bx-refresh me-1'></i> Refresh
                    </button>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Session ID</th>
                                    <th>Proxy</th>
                                    <th>External IP</th>
                                    <th>Location</th>
                                    <th>Started</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="sessions-table">
                                <tr>
                                    <td colspan="7" class="text-center">Loading sessions...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Users Page Template -->
    <template id="template-users">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">Users Management</h3>
                </div>
            </div>

            <!-- Users Stats -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card stat-card primary p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Total Users</h6>
                                <h3 class="mb-0" id="total-users-count">0</h3>
                            </div>
                            <i class='bx bx-user'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card stat-card success p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Active Users</h6>
                                <h3 class="mb-0" id="active-users-count">0</h3>
                            </div>
                            <i class='bx bx-user-check'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card stat-card info p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Trial Users</h6>
                                <h3 class="mb-0" id="trial-users-count">0</h3>
                            </div>
                            <i class='bx bx-time'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card stat-card warning p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">New Today</h6>
                                <h3 class="mb-0" id="new-users-today">0</h3>
                            </div>
                            <i class='bx bx-user-plus'></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users Table -->
            <div class="card">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">All Users</h5>
                    <button id="refresh-users" class="btn btn-sm btn-primary">
                        <i class='bx bx-refresh me-1'></i> Refresh
                    </button>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Trial Used</th>
                                    <th>Connection Time</th>
                                    <th>Created</th>
                                    <th>Last Active</th>
                                </tr>
                            </thead>
                            <tbody id="users-table">
                                <tr>
                                    <td colspan="8" class="text-center">Loading users...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- URL Services Page Template -->
    <template id="template-url-services">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">URL Services Management</h3>
                </div>
            </div>

            <!-- URL Services Stats -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card stat-card primary p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Total Services</h6>
                                <h3 class="mb-0" id="total-services-count">0</h3>
                            </div>
                            <i class='bx bx-link'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card stat-card success p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Active Services</h6>
                                <h3 class="mb-0" id="active-services-count">0</h3>
                            </div>
                            <i class='bx bx-check-circle'></i>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card stat-card info p-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="text-muted mb-0">Most Used</h6>
                                <h6 class="mb-0" id="most-used-service-name">None</h6>
                            </div>
                            <i class='bx bx-star'></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add New Service -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Add New URL Service</h5>
                        </div>
                        <div class="card-body">
                            <form id="add-service-form">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="service-name" class="form-label">Service Name</label>
                                            <input type="text" class="form-control" id="service-name" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6" style="display: none;">
                                        <div class="mb-3">
                                            <label for="service-url" class="form-label">Base URL (Hidden - Auto-filled)</label>
                                            <input type="url" class="form-control" id="service-url" value="https://auto-generated.com">
                                            <div class="form-text text-muted">This field is automatically filled for backward compatibility</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dual URL Tracking Section -->
                                <div class="row">
                                    <div class="col-12">
                                        <div class="mb-3">
                                            <div class="alert alert-success">
                                                <div class="form-check mb-2">
                                                    <input class="form-check-input" type="checkbox" id="enable-dual-url" checked>
                                                    <label class="form-check-label" for="enable-dual-url">
                                                        <strong><i class='bx bx-check-circle me-1'></i>✅ Dual-URL Tracking مفعل تلقائياً</strong>
                                                    </label>
                                                </div>
                                                <small class="text-success">
                                                    <i class='bx bx-check-circle me-1'></i>النظام جاهز لاستقبال الرابط المختصر والصفحة النهائية
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="dual-url-fields" class="row" style="display: block;">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="service-shortened-url" class="form-label">
                                                <i class='bx bx-link me-1'></i>🔗 الرابط المختصر (Shortened URL)
                                            </label>
                                            <input type="url" class="form-control" id="service-shortened-url" placeholder="https://short.ly/example">
                                            <div class="form-text">الرابط الأول اللي المستخدم هيضغط عليه (زي bit.ly أو jambo.ink)</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="service-target-url" class="form-label">
                                                <i class='bx bx-target-lock me-1'></i>🎯 الصفحة النهائية (Final Page)
                                            </label>
                                            <input type="url" class="form-control" id="service-target-url" placeholder="https://example.com/complete">
                                            <div class="form-text">الصفحة اللي المستخدم لازم يوصلها عشان المهمة تخلص</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="service-api-endpoint" class="form-label">API Endpoint (Optional)</label>
                                            <input type="text" class="form-control" id="service-api-endpoint">
                                        </div>
                                    </div>
                                                                    <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="service-random-enabled" class="form-label">Selection Method</label>
                                        <div class="alert alert-info">
                                            <i class='bx bx-shuffle me-2'></i>
                                            <strong>Random Selection Enabled</strong>
                                            <div class="form-text">When multiple services exist, the system will randomly select one for each user</div>
                                        </div>
                                        <input type="hidden" id="service-priority" value="1">
                                    </div>
                                </div>
                                </div>
                                <button type="submit" class="btn btn-primary">
                                    <i class='bx bx-plus me-1'></i>Add Service
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services Table -->
            <div class="card">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">URL Services</h5>
                    <button id="refresh-services" class="btn btn-sm btn-primary">
                        <i class='bx bx-refresh me-1'></i> Refresh
                    </button>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Base URL</th>
                                    <th>Shortened URL</th>
                                    <th>Target URL</th>
                                    <th>Tracking Type</th>
                                    <th>Selection</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="services-table">
                                <tr>
                                    <td colspan="8" class="text-center">Loading services...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Connection Logs Page Template -->
    <template id="template-logs">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">Connection Logs</h3>
                </div>
            </div>

            <!-- Logs Filters -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Filter Logs</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <label for="log-action-filter" class="form-label">Action</label>
                                    <select class="form-select" id="log-action-filter">
                                        <option value="">All Actions</option>
                                        <option value="connect">Connect</option>
                                        <option value="disconnect">Disconnect</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="log-user-filter" class="form-label">User ID</label>
                                    <input type="text" class="form-control" id="log-user-filter" placeholder="Enter user ID">
                                </div>
                                <div class="col-md-3">
                                    <label for="log-limit" class="form-label">Limit</label>
                                    <select class="form-select" id="log-limit">
                                        <option value="50">50 records</option>
                                        <option value="100" selected>100 records</option>
                                        <option value="200">200 records</option>
                                        <option value="500">500 records</option>
                                    </select>
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <button id="apply-log-filters" class="btn btn-primary me-2">Apply Filters</button>
                                    <button id="refresh-logs" class="btn btn-outline-secondary">Refresh</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Logs Table -->
            <div class="card">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Connection Logs</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>User ID</th>
                                    <th>Session ID</th>
                                    <th>Action</th>
                                    <th>Proxy Host</th>
                                    <th>Proxy Port</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="logs-table">
                                <tr>
                                    <td colspan="7" class="text-center">Loading logs...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- System Settings Page Template -->
    <template id="template-settings">
        <div class="container-fluid">
            <div class="row mb-4">
                <div class="col-md-12">
                    <h3 class="mb-3">System Settings</h3>
                </div>
            </div>

            <!-- Settings Categories -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Trial System Settings</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="enable-trial-system">
                                    <label class="form-check-label" for="enable-trial-system">
                                        Enable Trial System
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="trial-duration" class="form-label">Trial Duration (minutes)</label>
                                <input type="number" class="form-control" id="trial-duration" min="1">
                            </div>
                            <div class="mb-3">
                                <label for="trial-max-users" class="form-label">Max Trial Users</label>
                                <input type="number" class="form-control" id="trial-max-users" min="1">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Extension System Settings</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="enable-extensions">
                                    <label class="form-check-label" for="enable-extensions">
                                        Enable Extension System
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="extension-duration" class="form-label">Extension Duration (minutes)</label>
                                <input type="number" class="form-control" id="extension-duration" min="1">
                            </div>
                            <div class="mb-3">
                                <label for="max-extensions" class="form-label">Max Extensions per User</label>
                                <input type="number" class="form-control" id="max-extensions" min="1">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">Server Settings</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="server-maintenance">
                                    <label class="form-check-label" for="server-maintenance">
                                        Maintenance Mode
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="max-concurrent-sessions" class="form-label">Max Concurrent Sessions</label>
                                <input type="number" class="form-control" id="max-concurrent-sessions" min="1">
                            </div>
                            <div class="mb-3">
                                <label for="session-timeout" class="form-label">Session Timeout (minutes)</label>
                                <input type="number" class="form-control" id="session-timeout" min="1">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">URL Extension Settings</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="enable-url-extensions">
                                    <label class="form-check-label" for="enable-url-extensions">
                                        Enable URL Extension System
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="shortened-url" class="form-label">Shortened URL</label>
                                <input type="url" class="form-control" id="shortened-url" placeholder="https://short.ly/example">
                                <small class="text-muted">URL users will be redirected to</small>
                            </div>
                            <div class="mb-3">
                                <label for="destination-url" class="form-label">Destination URL</label>
                                <input type="url" class="form-control" id="destination-url" placeholder="https://example.com/complete">
                                <small class="text-muted">Final URL users reach after completion</small>
                            </div>
                            <div class="mb-3">
                                <label for="extension-hours" class="form-label">Extension Hours</label>
                                <input type="number" class="form-control" id="extension-hours" min="1" max="24" value="6">
                                <small class="text-muted">Hours to add when extension is completed</small>
                            </div>
                            <div class="d-grid">
                                <button type="button" class="btn btn-primary" onclick="saveUrlExtensionSettings()">
                                    <i class='bx bx-save me-2'></i>Save URL Extension Settings
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- URL Extension Statistics -->
                <div class="col-md-6">
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0">URL Extension Statistics</h5>
                        </div>
                        <div class="card-body">
                            <div id="url-extension-stats" class="stats-container">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="stat-item">
                                            <div class="stat-value" id="total-extensions">-</div>
                                            <div class="stat-label">Total Extensions</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="stat-item">
                                            <div class="stat-value" id="completed-extensions">-</div>
                                            <div class="stat-label">Completed</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <div class="stat-item">
                                            <div class="stat-value" id="completion-rate">-</div>
                                            <div class="stat-label">Completion Rate</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="stat-item">
                                            <div class="stat-value" id="avg-completion-time">-</div>
                                            <div class="stat-label">Avg. Time (min)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Settings Button -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-body text-center">
                            <button id="save-settings" class="btn btn-success btn-lg">
                                <i class='bx bx-save me-2'></i>Save All Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Edit URL Service Modal -->
    <div class="modal fade" id="editServiceModal" tabindex="-1" aria-labelledby="editServiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editServiceModalLabel">
                        <i class='bx bx-edit me-2'></i>Edit URL Service
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-service-form">
                        <input type="hidden" id="edit-service-id">

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-service-name" class="form-label">Service Name</label>
                                    <input type="text" class="form-control" id="edit-service-name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-service-url" class="form-label">Base URL</label>
                                    <input type="url" class="form-control" id="edit-service-url" required>
                                    <div class="form-text">Primary URL for the service (backward compatibility)</div>
                                </div>
                            </div>
                        </div>

                        <!-- Dual URL Tracking Section -->
                        <div class="row">
                            <div class="col-12">
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="edit-enable-dual-url">
                                        <label class="form-check-label" for="edit-enable-dual-url">
                                            <strong>Enable Dual-URL Tracking</strong>
                                            <small class="text-muted d-block">Track user journey from shortened URL to target completion page</small>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="edit-dual-url-fields" class="row" style="display: none;">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-service-shortened-url" class="form-label">
                                        <i class='bx bx-link me-1'></i>Shortened/Entry URL
                                    </label>
                                    <input type="url" class="form-control" id="edit-service-shortened-url">
                                    <div class="form-text">The initial URL users will click (e.g., bit.ly link)</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-service-target-url" class="form-label">
                                        <i class='bx bx-target-lock me-1'></i>Target/Destination URL
                                    </label>
                                    <input type="url" class="form-control" id="edit-service-target-url">
                                    <div class="form-text">The final page users must reach to complete the task</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-service-api-endpoint" class="form-label">API Endpoint (Optional)</label>
                                    <input type="text" class="form-control" id="edit-service-api-endpoint">
                                </div>
                            </div>
                            <div class="col-md-6">
                                                                        <div class="mb-3">
                                            <label for="edit-service-random" class="form-label">Selection Method</label>
                                            <div class="alert alert-info">
                                                <i class='bx bx-shuffle me-2'></i>
                                                <strong>Random Selection Active</strong>
                                                <div class="form-text">This service will be randomly selected along with others</div>
                                            </div>
                                            <input type="hidden" id="edit-service-priority" value="1">
                                        </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="edit-service-active" checked>
                                        <label class="form-check-label" for="edit-service-active">
                                            Service is Active
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class='bx bx-x me-1'></i>Cancel
                    </button>
                    <button type="button" class="btn btn-primary" id="save-service-changes">
                        <i class='bx bx-save me-1'></i>Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/app.js?v=20250625001"></script>
</body>
</html> 